<div class="tui-container tui-space_top-4">
  <h1>Zeta Counter</h1>

  <!-- Auth State -->
  <div class="auth-box tui-space_bottom-4">
    <ng-container *ngIf="auth.loading(); else authContent">
      <p>Loading auth...</p>
    </ng-container>
    <ng-template #authContent>
      <div *ngIf="auth.user() as user; else loginBtn">
        <p class="tui-text_body-m">Logged in as: <strong>{{ user.email }}</strong></p>
        <button tuiButton size="s" appearance="secondary" (click)="auth.logout()">
          Logout
        </button>
      </div>
      <ng-template #loginBtn>
        <p class="tui-text_body-m">Please login to use the counter.</p>
        <button tuiButton size="m" (click)="auth.login()">
          Login via WorkOS
        </button>
      </ng-template>
    </ng-template>
  </div>

  <!-- Counter -->
  <p class="tui-text_h3" *ngIf="!loading(); else loader">
    {{ count() }}
  </p>
  <ng-template #loader>
    <p class="tui-text_h3">...</p>
  </ng-template>

  <p *ngIf="error()" class="tui-text_body-s tui-space_bottom-4" style="color: red">
    {{ error() }}
  </p>

  <button
    tuiButton
    type="button"
    appearance="primary"
    [disabled]="!auth.user() || loading()"
    (click)="increment()"
  >
    Increment
  </button>
</div>
