<app-page-container>
  <div class="create-group-container">
    <h1 class="tui-text_h2">Create Group</h1>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="create-group-form">
      <div class="form-field">
        <tui-textfield>
          <label tuiLabel>Group Name</label>
          <input formControlName="name" tuiTextfield type="text" />
        </tui-textfield>

        <div
          *ngIf="form.get('name')?.invalid && form.get('name')?.touched"
          class="tui-text_body-s error-message"
        >
          Group name is required
        </div>
      </div>

      <div class="form-field">
        <label tuiLabel>Group Avatar</label>
        <input
          #fileInput
          type="file"
          accept="image/*"
          hidden
          (change)="onFileInputChange($event)"
        />
        <button
          type="button"
          tuiButton
          appearance="secondary"
          (click)="fileInput.click()"
          [disabled]="isSubmitting"
        >
          Select Image (max 300KB)
        </button>

        <div *ngIf="compressionError()" class="tui-text_body-s error-message">
          {{ compressionError() }}
        </div>

        <div *ngIf="avatarPreview()" class="avatar-preview-container">
          <img [src]="avatarPreview()" alt="Avatar preview" class="avatar-preview" />
          <p class="tui-text_body-xs preview-label">Avatar preview</p>
        </div>
      </div>

      <div class="form-actions">
        <button
          type="button"
          (click)="onCancel()"
          tuiButton
          appearance="secondary"
          [disabled]="isSubmitting"
        >
          Cancel
        </button>
        <button
          type="submit"
          [disabled]="form.invalid || isSubmitting || compressionError() !== null"
          tuiButton
          appearance="primary"
        >
          {{ isSubmitting ? 'Creating...' : 'Create Group' }}
        </button>
      </div>
    </form>
  </div>
</app-page-container>
